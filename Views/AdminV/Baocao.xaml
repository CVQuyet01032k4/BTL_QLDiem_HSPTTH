<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BTL_QLDiem_HSPTTH.AdminVM"
             x:Class="BTL_QLDiem_HSPTTH.Views.AdminV.Baocao"
             Title="Báo cáo thống kê"
             BackgroundColor="#F2F6FF">

    <ContentPage.BindingContext>
        <vm:BaocaoVM />
    </ContentPage.BindingContext>

    <VerticalStackLayout Padding="20" Spacing="15">

        <Picker Title="Chọn khối (tùy chọn)"
                ItemsSource="{Binding DanhsachKhoid}"
                SelectedItem="{Binding KhoidSelected}"
                ItemDisplayBinding="{Binding Tenkhoi}" />

        <Picker Title="Chọn lớp (tùy chọn)"
                ItemsSource="{Binding DanhsachLop}"
                SelectedItem="{Binding LopSelected}"
                ItemDisplayBinding="{Binding Tenlop}" />

        <Picker Title="Chọn học kỳ"
                ItemsSource="{Binding DanhsachHocky}"
                SelectedItem="{Binding HockySelected}"
                ItemDisplayBinding="{Binding Tenhocky}" />

        <Button Text="Xem báo cáo"
                BackgroundColor="#0A66FF"
                TextColor="White"
                Command="{Binding LoadThongKeCommand}" />

        <CollectionView ItemsSource="{Binding DanhsachThongKe}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Padding="15" Margin="0,5" BackgroundColor="White" StrokeShape="RoundRectangle 10">
                        <VerticalStackLayout>
                            <Label Text="{Binding TenLop}" FontSize="18" FontAttributes="Bold" TextColor="#0A66FF"/>
                            <Label Text="{Binding SoLuongHS, StringFormat='Tổng số HS: {0}'}" FontSize="14"/>
                            <Label Text="{Binding DiemTrungBinhLop, StringFormat='Điểm TB lớp: {0:F2}'}" FontSize="14" FontAttributes="Bold"/>
                            
                            <HorizontalStackLayout Margin="0,10,0,0">
                                <Label Text="{Binding SoLuongGioi, StringFormat='Giỏi: {0}'}" FontSize="12" TextColor="Green"/>
                                <Label Text="{Binding SoLuongKha, StringFormat='Khá: {0}'}" FontSize="12" TextColor="Blue" Margin="10,0,0,0"/>
                                <Label Text="{Binding SoLuongTrungBinh, StringFormat='TB: {0}'}" FontSize="12" TextColor="Orange" Margin="10,0,0,0"/>
                                <Label Text="{Binding SoLuongYeu, StringFormat='Yếu: {0}'}" FontSize="12" TextColor="Red" Margin="10,0,0,0"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </VerticalStackLayout>

</ContentPage>
